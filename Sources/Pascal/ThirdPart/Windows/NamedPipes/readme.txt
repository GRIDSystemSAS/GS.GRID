From https://github.com/kami-soft/NamedPipeExchange